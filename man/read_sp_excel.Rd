% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/excel_operations.R
\name{read_sp_excel}
\alias{read_sp_excel}
\title{Read an Excel File from SharePoint}
\usage{
read_sp_excel(file_path, drive, sheet = 1, startRow = 1, colNames = TRUE, ...)
}
\arguments{
\item{file_path}{Character string. The path to the Excel file on the SharePoint drive.}

\item{drive}{A SharePoint drive object, as returned by \code{\link{get_sp_drive}}.}

\item{sheet}{Either a string naming a sheet or an integer specifying the sheet's position.
Default is 1 (the first sheet).}

\item{startRow}{Integer. The row to start reading from. Default is 1.}

\item{colNames}{Logical. Whether the first row contains column names. Default is TRUE.}

\item{...}{Additional arguments passed to \code{\link[openxlsx]{read.xlsx}}.}
}
\value{
A data frame containing the Excel data.
}
\description{
Downloads and reads an Excel file (.xlsx, .xls) from SharePoint into an R data frame.
}
\details{
This function downloads the Excel file to a temporary location and then reads it into R
using the \code{\link[openxlsx]{read.xlsx}} function. The temporary file is
automatically deleted after reading.

The function supports both .xlsx and .xls file formats. For complex Excel files with
formatting, formulas, or multiple sheets, you may need to use additional parameters
via the ... argument.
}
\examples{
\dontrun{
# Connect to SharePoint and get drive
site <- connect_sharepoint("https://example.sharepoint.com/sites/mysite")
drive <- get_sp_drive(site, "Documents")

# Read the first sheet of an Excel file
data <- read_sp_excel("reports/quarterly_data.xlsx", drive)

# Read a specific named sheet
sales_data <- read_sp_excel("reports/quarterly_data.xlsx", drive, sheet = "Sales")

# Read with specific options
data <- read_sp_excel("reports/quarterly_data.xlsx", drive,
                      sheet = 2, startRow = 3, colNames = FALSE)
}

}
