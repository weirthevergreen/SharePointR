% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/csv_operations.R
\name{write_sp_csv}
\alias{write_sp_csv}
\title{Write a Data Frame to a CSV File on SharePoint}
\usage{
write_sp_csv(data, file_path, drive, overwrite = FALSE, ...)
}
\arguments{
\item{data}{A data frame to write to CSV.}

\item{file_path}{Character string. The path where the file should be written within the SharePoint drive.}

\item{drive}{A SharePoint drive object, as returned by \code{\link{get_sp_drive}}.}

\item{overwrite}{Logical. If TRUE, overwrites the file if it already exists. Default is FALSE.}

\item{...}{Additional arguments passed to \code{\link[utils]{write.csv}}.}
}
\value{
Returns console message indicating status of export.
}
\description{
Writes an R data frame to a CSV file on a SharePoint drive.
}
\details{
This function first writes the data to a temporary file and then uploads it to SharePoint.
The temporary file is automatically deleted after uploading.

Folders in the file_path must already exist. The function will not create new folders.
If you want to write to a nested folder structure, ensure all folders exist
on the SharePoint drive first.
}
\examples{
\dontrun{
# Connect to SharePoint and get drive
site <- connect_sharepoint("https://example.sharepoint.com/sites/mysite")
drive <- get_sp_drive(site, "Documents")

# Create a simple data frame
df <- data.frame(x = 1:10, y = letters[1:10])

# Write to a file in the root of the drive
write_sp_csv(df, "mydata.csv", drive)

# Write to a subfolder, overwriting if exists
write_sp_csv(df, "reports/monthly/data.csv", drive, overwrite = TRUE)

# Use additional arguments for write.csv
write_sp_csv(df, "data.csv", drive, row.names = TRUE, na = "NA")
}

}
