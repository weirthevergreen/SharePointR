% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/excel_operations.R
\name{write_sp_excel}
\alias{write_sp_excel}
\title{Write a Data Frame to an Excel File on SharePoint}
\usage{
write_sp_excel(
  data,
  file_path,
  drive,
  sheet = "Sheet1",
  overwrite = FALSE,
  ...
)
}
\arguments{
\item{data}{A data frame or a named list of data frames to write to Excel.}

\item{file_path}{Character string. The path where the file should be written on the SharePoint drive.}

\item{drive}{A SharePoint drive object, as returned by \code{\link{get_sp_drive}}.}

\item{sheet}{Character string. The name of the sheet to write to (when data is a single data frame).
Default is "Sheet1".}

\item{overwrite}{Logical. If TRUE, overwrites the file if it already exists. Default is FALSE.}

\item{...}{Additional arguments passed to \code{\link[openxlsx]{write.xlsx}} or \code{\link[openxlsx]{writeData}}.}
}
\value{
Returns console message indicating status of export.
}
\description{
Writes an R data frame, or multiple data frames, to an Excel file on a SharePoint drive.
}
\details{
This function writes a data frame or multiple data frames to an Excel file on SharePoint.
It first creates a temporary file and then uploads it to the specified location.
The temporary file is automatically deleted after uploading.

Folders in the file_path must already exist. The function will not create new folders.
If you want to write to a nested folder structure, ensure all folders exist
on the SharePoint drive first.

To write multiple data frames to different sheets, provide a named list of data frames
where the names will be used as sheet names.
}
\examples{
\dontrun{
# Connect to SharePoint and get drive
site <- connect_sharepoint("https://example.sharepoint.com/sites/mysite")
drive <- get_sp_drive(site, "Documents")

# Write a single data frame to Excel
df <- data.frame(x = 1:10, y = letters[1:10])
write_sp_excel(df, "reports/data.xlsx", drive)

# Write to a specific sheet name
write_sp_excel(df, "reports/data.xlsx", drive, sheet = "MyData", overwrite = TRUE)

# Write multiple data frames to different sheets
sales <- data.frame(month = month.name, amount = runif(12, 1000, 5000))
expenses <- data.frame(month = month.name, amount = runif(12, 500, 3000))
profit <- data.frame(month = month.name, amount = sales$amount - expenses$amount)

# Create a named list of data frames
report_data <- list(
  "Sales" = sales,
  "Expenses" = expenses,
  "Profit" = profit
)

# Write all data frames to a single Excel file with multiple sheets
write_sp_excel(report_data, "reports/financial_report.xlsx", drive)
}

}
